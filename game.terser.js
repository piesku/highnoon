"use strict";(()=>{function t(t,n){t.t[n]=0,t.i.push(n)}function n(t,n){let e=(i=t.o).i.length>0?i.i.pop():i.t.push(0)-1;var i;for(let i of n)i(t,e);return e}function e(...t){return(e,i)=>{16&e.o.t[i]||(e.o.t[i]|=16,e.o.l[i]={l:[]});let o=e.o.l[i].l;for(let i of t){let t=n(e,i);o.push(t)}}}function*i(t,n,e){if((t.t[n]&e)===e&&(yield n),16&t.t[n])for(let o of t.l[n].l)yield*i(t,o,e)}function o(n,e){if(16&n.t[e])for(let t of n.l[e].l)o(n,t);0===n.t[e]||t(n,e)}function r(t,n,e){switch(n){case 0:document.fullscreenElement?document.exitFullscreen():document.body.requestFullscreen();break;case 1:{let[n]=e;o(t.o,n),t.u++;break}case 2:t.h++}}function l(t,n,e){let i=t.createProgram();return t.attachShader(i,a(t,dn,n)),t.attachShader(i,a(t,hn,e)),t.linkProgram(i),i}function a(t,n,e){let i=t.createShader(n);return t.shaderSource(i,e),t.compileShader(i),i}function c(t,n,e){return Math.max(t,Math.min(n,e))}function s(t,n,e,i){return t[0]=n,t[1]=e,t[2]=i,t}function u(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function f(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t}function h(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t}function d(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function v(t,n){let e=n[0],i=n[1],o=n[2],r=e*e+i*i+o*o;return r>0&&(r=1/Math.sqrt(r)),t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t}function m(t,n,e){let i=n[0],o=n[1],r=n[2],l=e[3]*i+e[7]*o+e[11]*r+e[15]||1;return t[0]=(e[0]*i+e[4]*o+e[8]*r+e[12])/l,t[1]=(e[1]*i+e[5]*o+e[9]*r+e[13])/l,t[2]=(e[2]*i+e[6]*o+e[10]*r+e[14])/l,t}function _(t,n,e){let i=n[0],o=n[1],r=n[2];return t[0]=e[0]*i+e[4]*o+e[8]*r,t[1]=e[1]*i+e[5]*o+e[9]*r,t[2]=e[2]*i+e[6]*o+e[10]*r,t}function M(t,n,e,i){let o=n[0],r=n[1],l=n[2];return t[0]=o+i*(e[0]-o),t[1]=r+i*(e[1]-r),t[2]=l+i*(e[2]-l),t}function g(t,n,e,i,o){return t[0]=n,t[1]=e,t[2]=i,t[3]=o,t}function p(t,n,e){let i=n[0],o=n[1],r=n[2],l=n[3],a=e[0],c=e[1],s=e[2],u=e[3];return t[0]=i*u+l*a+o*s-r*c,t[1]=o*u+l*c+r*a-i*s,t[2]=r*u+l*s+i*c-o*a,t[3]=l*u-i*a-o*c-r*s,t}function w(t,n,e,i){let o=Math.sin(n/2*jn),r=Math.cos(n/2*jn),l=Math.sin(e/2*jn),a=Math.cos(e/2*jn),c=Math.sin(i/2*jn),s=Math.cos(i/2*jn);return t[0]=o*a*s+r*l*c,t[1]=r*l*s-o*a*c,t[2]=r*a*c-o*l*s,t[3]=r*a*s+o*l*c,t}function y(t){return Math.asin(-c(-1,1,2*(t[1]*t[2]-t[3]*t[0])))*Hn}function b(t,n,e){let i=e/2;return t[0]=Math.sin(i)*n[0],t[1]=Math.sin(i)*n[1],t[2]=Math.sin(i)*n[2],t[3]=Math.cos(i),t}function C(t,n,e,i){let o,r,l,a,c,s=n[0],u=n[1],f=n[2],h=n[3],d=e[0],v=e[1],m=e[2],_=e[3];return r=s*d+u*v+f*m+h*_,r<0&&(r=-r,d=-d,v=-v,m=-m,_=-_),1-r>Xn?(o=Math.acos(r),l=Math.sin(o),a=Math.sin((1-i)*o)/l,c=Math.sin(i*o)/l):(a=1-i,c=i),t[0]=a*s+c*d,t[1]=a*u+c*v,t[2]=a*f+c*m,t[3]=a*h+c*_,t}function A(t,n,e){let i=t.o.v[n],o=t.o.m[n];if(o._){let t=o.M[o._];t&&t!==o.g&&(0===o.g.p?o.g=t:1&o.g.C&&(o.g.p=0,o.g=t)),o._=void 0}let r=null,l=null;for(let t of o.g.A){if(o.g.p<t.k){l=t;break}r=t}if(r&&l){let e=(o.g.p-r.k)/(l.k-r.k);l.T&&(e=l.T(e)),r.D&&l.D&&(M(i.D,r.D,l.D,e),t.o.t[n]|=256),r.F&&l.F&&(C(i.F,r.F,l.F,e),t.o.t[n]|=256),r.S&&l.S&&(M(i.S,r.S,l.S,e),t.o.t[n]|=256)}let a=o.g.p+e;if(a<o.g.P)o.g.p=a;else{if(o.g.p=0,4&o.g.C)for(let t of o.g.A.reverse())t.k=o.g.P-t.k;2&o.g.C||(o.g=o.M.idle)}}function k(t,n){let e=n[0],i=n[1],o=n[2],r=n[3],l=n[4],a=n[5],c=n[6],s=n[7],u=n[8],f=n[9],h=n[10],d=n[11],v=n[12],m=n[13],_=n[14],M=n[15],g=e*a-i*l,p=e*c-o*l,w=e*s-r*l,y=i*c-o*a,b=i*s-r*a,C=o*s-r*c,A=u*m-f*v,k=u*_-h*v,T=u*M-d*v,x=f*_-h*m,E=f*M-d*m,D=h*M-d*_,F=g*D-p*E+w*x+y*T-b*k+C*A;return F?(F=1/F,t[0]=(a*D-c*E+s*x)*F,t[1]=(o*E-i*D-r*x)*F,t[2]=(m*C-_*b+M*y)*F,t[3]=(h*b-f*C-d*y)*F,t[4]=(c*T-l*D-s*k)*F,t[5]=(e*D-o*T+r*k)*F,t[6]=(_*w-v*C-M*p)*F,t[7]=(u*C-h*w+d*p)*F,t[8]=(l*E-a*T+s*A)*F,t[9]=(i*T-e*E-r*A)*F,t[10]=(v*b-m*w+M*g)*F,t[11]=(f*w-u*b-d*g)*F,t[12]=(a*k-l*x-c*A)*F,t[13]=(e*x-i*k+o*A)*F,t[14]=(m*p-v*y-_*g)*F,t[15]=(u*y-f*p+h*g)*F,t):null}function T(t,n,e){let i=n[0],o=n[1],r=n[2],l=n[3],a=n[4],c=n[5],s=n[6],u=n[7],f=n[8],h=n[9],d=n[10],v=n[11],m=n[12],_=n[13],M=n[14],g=n[15],p=e[0],w=e[1],y=e[2],b=e[3];return t[0]=p*i+w*a+y*f+b*m,t[1]=p*o+w*c+y*h+b*_,t[2]=p*r+w*s+y*d+b*M,t[3]=p*l+w*u+y*v+b*g,p=e[4],w=e[5],y=e[6],b=e[7],t[4]=p*i+w*a+y*f+b*m,t[5]=p*o+w*c+y*h+b*_,t[6]=p*r+w*s+y*d+b*M,t[7]=p*l+w*u+y*v+b*g,p=e[8],w=e[9],y=e[10],b=e[11],t[8]=p*i+w*a+y*f+b*m,t[9]=p*o+w*c+y*h+b*_,t[10]=p*r+w*s+y*d+b*M,t[11]=p*l+w*u+y*v+b*g,p=e[12],w=e[13],y=e[14],b=e[15],t[12]=p*i+w*a+y*f+b*m,t[13]=p*o+w*c+y*h+b*_,t[14]=p*r+w*s+y*d+b*M,t[15]=p*l+w*u+y*v+b*g,t}function x(t,n,e,i){let o=n[0],r=n[1],l=n[2],a=n[3],c=o+o,s=r+r,u=l+l,f=o*c,h=o*s,d=o*u,v=r*s,m=r*u,_=l*u,M=a*c,g=a*s,p=a*u,w=i[0],y=i[1],b=i[2];return t[0]=(1-(v+_))*w,t[1]=(h+p)*w,t[2]=(d-g)*w,t[3]=0,t[4]=(h-p)*y,t[5]=(1-(f+_))*y,t[6]=(m+M)*y,t[7]=0,t[8]=(d+g)*b,t[9]=(m-M)*b,t[10]=(1-(f+v))*b,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function E(t,n,e,i,o,r,l){let a=1/(o-e),c=1/(i-n),s=1/(r-l);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*s,t[11]=0,t[12]=(o+e)*a,t[13]=(n+i)*c,t[14]=(l+r)*s,t[15]=1,t}function D(t,n){return t[0]=n[8],t[1]=n[9],t[2]=n[10],v(t,t)}function F(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function S(t,n){let e=function(t,n){let e=n[4],i=n[5],o=n[6],r=n[8],l=n[9],a=n[10];return t[0]=Math.hypot(n[0],n[1],n[2]),t[1]=Math.hypot(e,i,o),t[2]=Math.hypot(r,l,a),t}([0,0,0],n),i=1/e[0],o=1/e[1],r=1/e[2],l=n[0]*i,a=n[1]*o,c=n[2]*r,s=n[4]*i,u=n[5]*o,f=n[6]*r,h=n[8]*i,d=n[9]*o,v=n[10]*r,m=l+u+v,_=0;return m>0?(_=2*Math.sqrt(m+1),t[3]=.25*_,t[0]=(f-d)/_,t[1]=(h-c)/_,t[2]=(a-s)/_):l>u&&l>v?(_=2*Math.sqrt(1+l-u-v),t[3]=(f-d)/_,t[0]=.25*_,t[1]=(a+s)/_,t[2]=(h+c)/_):u>v?(_=2*Math.sqrt(1+u-l-v),t[3]=(h-c)/_,t[0]=(a+s)/_,t[1]=.25*_,t[2]=(f+d)/_):(_=2*Math.sqrt(1+v-l-u),t[3]=(a-s)/_,t[0]=(h+c)/_,t[1]=(f+d)/_,t[2]=.25*_),t}function P(t,n){let e=t[12]-n[0],i=t[13]-n[1],o=t[14]-n[2];return e*e+i*i+o*o}function $(t,n){let e=t.o.v[n];var i,o;F(Jn,e.o),D(Qn,e.o),(i=Zn)[0]=(o=e.o)[4],i[1]=o[5],i[2]=o[6],v(i,i);let r=t.Audio.listener;r.positionX?(r.positionX.value=Jn[0],r.positionY.value=Jn[1],r.positionZ.value=Jn[2],r.forwardX.value=Qn[0],r.forwardY.value=Qn[1],r.forwardZ.value=Qn[2],r.upX.value=Zn[0],r.upY.value=Zn[1],r.upZ.value=Zn[2]):(r.setPosition(...Jn),r.setOrientation(...Qn,...Zn))}function I(t=0,n=1){return((te=16807*te%2147483647)-1)/2147483646*(n-t)+t}function R(t,n,e,i,o){let r=t.currentTime+o,l=0;n&&n.connect(t.destination);let a,c,s=t.createGain();if(s.gain.value=(e[0]/9)**3,e[5]&&(c=t.createOscillator(),c.type=e[5],c.frequency.value=(e[7]/3)**3,a=t.createGain(),a.gain.value=(e[6]+3)**3,c.connect(a)),e[1]){let i=t.createBiquadFilter();i.type=e[1],i.frequency.value=2**e[2],i.Q.value=e[3]**1.5,a&&e[4]&&a.connect(i.detune),s.connect(i),i.connect(n||t.destination)}else s.connect(n||t.destination);for(let n of e[8]){let e=t.createGain();e.connect(s);let o=(n[1]/9)**3,c=(n[2]/9)**3,u=(n[3]/9)**3,f=c+u+(n[4]/6)**3;if(e.gain.setValueAtTime(0,r),e.gain.linearRampToValueAtTime(o,r+c),e.gain.setValueAtTime(o,r+c+u),e.gain.exponentialRampToValueAtTime(1e-5,r+f),n[0]){let o=t.createOscillator();o.type=n[0],o.connect(e),o.detune.value=3*(n[5]-7.5)**3,a&&n[6]&&a.connect(o.detune);let l=440*2**((i-69)/12);if(n[7]){let t=(n[8]/9)**3,e=(n[9]/9)**3,i=(n[10]/6)**3;o.frequency.linearRampToValueAtTime(0,r),o.frequency.linearRampToValueAtTime(l,r+t),o.frequency.setValueAtTime(l,r+t+e),o.frequency.exponentialRampToValueAtTime(1e-5,r+t+e+i)}else o.frequency.setValueAtTime(l,r);o.start(r),o.stop(r+f)}else{let n=t.createBufferSource();n.buffer=L(t),n.loop=!0,n.connect(e),n.start(r),n.stop(r+f)}f>l&&(l=f)}c&&(c.start(r),c.stop(r+l))}function L(t){if(!Ut){let n=(Ut=t.createBuffer(1,2*t.sampleRate,t.sampleRate)).getChannelData(0);for(let t=0;t<n.length;t++)n[t]=2*Math.random()-1}return Ut}function z(t,n,e){let i=t.o.$[n],o=t.o.v[n];if(i.g&&(i.p+=e,i.p>i.g.I?i.g=void 0:i.R&&G(i.R,o)),i._&&!i.g){switch(i._.L){case 0:!function(t,n,e){let i=t.createBufferSource();i.buffer=e.G,n?(i.connect(n),n.connect(t.destination)):i.connect(t.destination),i.start()}(t.Audio,i.R,i._);break;case 1:!function(t,n,e){let i=60/(e.O||120)/4;for(let o of e.K)for(let e=0;e<o.N.length;e++)o.N[e]&&R(t,n,o.B,o.N[e],e*i)}(t.Audio,i.R,i._)}i.g=i._,i.p=0,i.R&&G(i.R,o)}i._=i.V}function G(t,n){F(ee,n.o),D(ie,n.o),t.positionX?(t.positionX.value=ee[0],t.positionY.value=ee[1],t.positionZ.value=ee[2],t.orientationX.value=ie[0],t.orientationY.value=ie[1],t.orientationZ.value=ie[2]):(t.setPosition(...ee),t.setOrientation(...ie))}function O(t,n=[.9,.9,.9,1],e=tn|Zt){return(i,o)=>{i.o.t[o]|=8,i.o.W[o]={L:0,Y:t,o:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],X:0,j:0,H:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],q:[0,0,0],U:n,J:t.Z,tt:n,nt:e}}}function K(t,n,e){let i=t.o.v[n];T(e.H,e.Y.Y,i.et),F(e.q,i.o)}function N(t,n){let e,i,o,r,l,a;F(n.it,t),e=r=n.it[0],i=l=n.it[1],o=a=n.it[2];let c=[0,0,0];for(let s=0;s<8;s++){let u=re[s];c[0]=u[0]*n.ot[0],c[1]=u[1]*n.ot[1],c[2]=u[2]*n.ot[2],m(c,c,t),c[0]<e&&(e=c[0]),c[0]>r&&(r=c[0]),c[1]<i&&(i=c[1]),c[1]>l&&(l=c[1]),c[2]<o&&(o=c[2]),c[2]>a&&(a=c[2])}n.rt=[e,i,o],n.lt=[r,l,a],n.ct[0]=(r-e)/2,n.ct[1]=(l-i)/2,n.ct[2]=(a-o)/2}function B(t,n){let e=t.it[0]-n.it[0],i=t.ct[0]+n.ct[0]-Math.abs(e),o=t.it[1]-n.it[1],r=t.ct[1]+n.ct[1]-Math.abs(o),l=t.it[2]-n.it[2],a=t.ct[2]+n.ct[2]-Math.abs(l);return i<r&&i<a?[i*Math.sign(e),0,0]:r<a?[0,r*Math.sign(o),0]:[0,0,a*Math.sign(l)]}function V(t,n,e){for(let r=0;r<e;r++){let e=n[r],l=t.st&e.ut,a=e.st&t.ut;if((l||a)&&(i=t).rt[0]<(o=e).lt[0]&&i.lt[0]>o.rt[0]&&i.rt[1]<o.lt[1]&&i.lt[1]>o.rt[1]&&i.rt[2]<o.lt[2]&&i.lt[2]>o.rt[2]){let n=B(t,e);l&&t.ft.push({ht:e.dt,vt:n}),a&&e.ft.push({ht:t.dt,vt:d([0,0,0],n)})}}var i,o}function W(t,n){let e=t.o._t[n],o=t.o.Mt[n];if(e.gt&&f(o.gt,o.gt,e.gt),e.F&&p(o.wt,o.wt,e.F),e.Animation)for(let o of i(t.o,n,1))t.o.m[o]._=e.Animation}function Y(t,n){let e=t.o.yt[n];if(t.o.bt[n].Mt&&t.Ct.Space&&e.At){e.kt[1]=300;for(let e of i(t.o,n,1))t.o.m[e]._="jump"}}function X(t,n){let e=t.o.bt[n];if(e.Mt){let e=t.o.Mt[n];t.Ct.KeyW&&(e.gt[2]+=1),t.Ct.KeyA&&(e.gt[0]+=1),t.Ct.KeyS&&(e.gt[2]-=1),t.Ct.KeyD&&(e.gt[0]-=1)}if(e.Tt){let e=t.o.Mt[n];t.Ct.ArrowLeft&&p(e.wt,e.wt,[0,1,0,0]),t.Ct.ArrowRight&&p(e.wt,e.wt,[0,-1,0,0])}if(e.xt){let i=t.o.Mt[n],o=y(t.o.v[n].F);t.Ct.ArrowUp&&o>e.Et&&p(i.Dt,i.Dt,[-1,0,0,0]),t.Ct.ArrowDown&&o<e.Ft&&p(i.Dt,i.Dt,[1,0,0,0])}}function j(t,n){let e=t.o.bt[n],i=t.o.v[n];if(e.Tt&&t.St.MouseX&&(b(he,fe,-t.St.MouseX*e.Tt*jn),p(i.F,he,i.F),t.o.t[n]|=256),e.xt&&t.St.MouseY){let o=y(i.F),r=c(e.Et-o,e.Ft-o,t.St.MouseY*e.xt);b(he,ue,r*jn),p(i.F,i.F,he),t.o.t[n]|=256}}function H(t,n){let e=t.o.v[n],i=t.o.bt[n],o=t.o.Mt[n];if(i.Mt&&1===t.Ct.Touch0){let n=Math.min(t.X,t.j)/4,e=(t.Ct.Touch0X-Me[0])/n,i=(t.Ct.Touch0Y-Me[1])/n;Math.abs(e)>me&&(o.gt[0]+=c(-1,1,-e)),Math.abs(i)>me&&(o.gt[2]+=c(-1,1,-i))}if(i.Tt&&t.St.Touch1X&&(b(ge,de,-t.St.Touch1X*i.Tt*_e*jn),p(e.F,ge,e.F),t.o.t[n]|=256),i.xt&&t.St.Touch1Y){let o=y(e.F),r=c(i.Et-o,i.Ft-o,t.St.Touch1Y*i.xt*_e);b(ge,ve,r*jn),p(e.F,e.F,ge),t.o.t[n]|=256}}function q(t,n){let e=t.o.bt[n];if(e.Mt){let e=t.o.Mt[n];Math.abs(t.St.pad0_axis_1)>ye&&(e.gt[0]-=t.St.pad0_axis_1),Math.abs(t.St.pad0_axis_2)>ye&&(e.gt[2]-=t.St.pad0_axis_2)}if(e.Tt&&Math.abs(t.St.pad0_axis_3)>ye){let e=t.o.Mt[n];p(e.wt,e.wt,b([0,0,0,1],pe,-t.St.pad0_axis_3*Math.PI))}if(e.xt&&Math.abs(t.St.pad0_axis_4)>ye){let i=t.o.Mt[n],o=t.St.pad0_axis_4*Math.PI,r=y(t.o.v[n].F);(o<0&&r>e.Et||o>0&&r<e.Ft)&&p(i.Dt,i.Dt,b([0,0,0,1],we,o))}}function U(t,n,e,i=0,o=0,r=[1,1,1],l=ln){return(a,c)=>{a.o.t[c]|=65536,a.o.Pt[c]={L:1,$t:t,It:n,Rt:e[3]<1?1:0,Lt:l,zt:e,Gt:[...r,i],Ot:[e[0],e[1],e[2],o]}}}function J(t=[0,0,0],n=[0,0,0,1],e=[1,1,1],i=!1){return(o,r)=>{o.o.t[r]|=4194560,o.o.v[r]={o:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],et:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],D:t,F:n,S:e,Kt:i}}}function Q(t,n,e){return(i,o)=>{let r=i.o.v[o];r.D[0]=t,r.D[1]=n,r.D[2]=e}}function Z(t,n,e){return(i,o)=>{w(i.o.v[o].F,t,n,e)}}function tt(t,n,e){return(i,o)=>{let r=i.o.v[o];r.S[0]=t,r.S[1]=n,r.S[2]=e}}function nt(t,n){t.Nt.textAlign="center",t.Nt.font=n.Bt,t.Nt.fillStyle=n.Vt,t.Nt.fillText(n.Text,0,0)}function et(t,n){t.Nt.strokeStyle=n.Wt,t.Nt.strokeRect(-n.ot/2,-n.ot/2,n.ot,n.ot)}function it(t,n,e){let i=t.o.Yt[n];i.Xt-=e,i.Xt<0&&(i.jt&&r(t,i.jt,n),o(t.o,n))}function ot(t,n,e){let i=t.o.Ht[n],o=t.o.v[n];2===i.L?D(Te,o.o):F(Te,o.o),t.qt[4*e+0]=Te[0],t.qt[4*e+1]=Te[1],t.qt[4*e+2]=Te[2],t.qt[4*e+3]=i.L,t.Ut[4*e+0]=i.Wt[0],t.Ut[4*e+1]=i.Wt[1],t.Ut[4*e+2]=i.Wt[2],t.Ut[4*e+3]=i.Jt}function rt(t,n){let e=t.o.v[n],i=t.o.Qt[n],o=t.o.v[i.Zt];F(Ee,o.o),S(De,o.o),M(e.D,e.D,Ee,i.tn),C(e.F,e.F,De,i.tn),t.o.t[n]|=256}function lt(t,n,e){let i=t.o.v[n],o=t.o.Mt[n];if(0!==o.gt[0]||0!==o.gt[1]||0!==o.gt[2]){let l=Math.min(1,Math.hypot((r=o.gt)[0],r[1],r[2]));_(o.gt,o.gt,i.o),void 0!==i.nn&&_(o.gt,o.gt,t.o.v[i.nn].et),v(o.gt,o.gt),h(o.gt,o.gt,l*o.en*e),f(i.D,i.D,o.gt),t.o.t[n]|=256,s(o.gt,0,0,0)}var r;o.wt[3]<1&&(p(o.wt,o.wt,i.F),C(i.F,i.F,o.wt,Math.min(1,o.on/Math.PI*e)),t.o.t[n]|=256,g(o.wt,0,0,0,1)),o.Dt[3]<1&&(p(o.Dt,i.F,o.Dt),C(i.F,i.F,o.Dt,Math.min(1,o.on/Math.PI*e)),t.o.t[n]|=256,g(o.Dt,0,0,0,1))}function at(t,n,e){let i=t.o.rn[n],o=t.o.v[n];i.ln+=e,i.ln>i.an&&(i.ln=0,F(Pe,o.o),D($e,o.o),i.cn.push(...Pe,0),i.cn.push(...$e,Math.random()));for(let t=0;t<i.cn.length;)i.cn[t+3]+=e,i.cn[t+3]>i.Yt?i.cn.splice(t,be):t+=be}function ct(t,n=.5){return(e,i)=>{e.o.t[i]|=131072,e.o.yt[i]={L:t,sn:i,un:n,kt:[0,0,0],fn:[0,0,0],hn:[0,0,0],dn:[0,0,0],At:!1}}}function st(t,n,e){let i=t.o.v[n],o=t.o.yt[n];1===o.L&&(o.fn[1]+=Re*e,h(o.kt,o.kt,e),f(o.fn,o.fn,o.kt),h(Le,o.fn,e),f(i.D,i.D,Le),t.o.t[n]|=256,s(o.kt,0,0,0))}function ut(t,n,e){let i=t.o.yt[n];var o,r,l;F(Ge,t.o.v[n].o),2===i.L&&((o=Oe)[0]=(r=Ge)[0]-(l=i.dn)[0],o[1]=r[1]-l[1],o[2]=r[2]-l[2],h(i.fn,Oe,1/e)),u(i.dn,Ge)}function ft(t,n){let e=t.o.v[n],i=t.o.yt[n],o=t.o.vn[i.sn];if(1===i.L){i.At=!1,s(Be,0,0,0);for(let n=0;n<o.ft.length;n++){let e=o.ft[n];if(131072&t.o.t[e.ht]){let n=t.o.yt[e.ht];switch(n.L){case 0:ht(Be,e.vt,Be),v(Ne,e.vt),h(Ne,Ne,-2*((r=i.fn)[0]*(l=Ne)[0]+r[1]*l[1]+r[2]*l[2])),f(i.hn,i.fn,Ne);break;case 1:case 2:ht(Be,Be,e.vt),u(i.hn,n.fn)}h(i.hn,i.hn,i.un),e.vt[1]>0&&(i.At=!0)}}Be[0]||Be[1]||Be[2]?(Math.abs(Be[0])<.1&&(Be[0]=0),Math.abs(Be[2])<.1&&(Be[2]=0),f(e.D,e.D,Be),t.o.t[n]|=256):u(i.hn,i.fn)}var r,l}function ht(t,n,e){t[0]=n[0]>=0&&e[0]>=0?Math.max(n[0],e[0]):n[0]<=0&&e[0]<=0?Math.min(n[0],e[0]):n[0],n[1]>=0&&e[1]>=0?t[1]=Math.max(n[1],e[1]):n[1]<=0&&e[1]<=0?t[1]=Math.min(n[1],e[1]):n[1]>e[1]&&(t[1]=n[1]),t[2]=n[2]>=0&&e[2]>=0?Math.max(n[2],e[2]):n[0]<=0&&e[0]<=0?Math.min(n[2],e[2]):n[2]}function dt(t,n){if(16&t.t[n]){let e=t.l[n];for(let n of e.l)if(1048576&t.t[n])return!0}return!1}function vt(t,n,e,i){return t.bindTexture(wn,n),t.texImage2D(wn,0,Dn,e,i,0,fn,sn,null),t.texParameteri(wn,Mn,vn),t.texParameteri(wn,_n,vn),n}function mt(t,n,e,i){return t.bindTexture(wn,n),t.texImage2D(wn,0,Sn,e,i,0,un,cn,null),t.texParameteri(wn,Mn,mn),t.texParameteri(wn,_n,mn),t.texParameteri(wn,xn,En),t.texParameteri(wn,gn,kn),t.texParameteri(wn,pn,kn),n}function _t(t,n,e,i){n.mn=e,n._n=i,function(t,n,e,i){t.bindTexture(wn,n),t.texImage2D(wn,0,Tn,e,i,0,fn,an,null),t.texParameteri(wn,Mn,mn),t.texParameteri(wn,_n,mn)}(t,n.Mn,n.mn,n._n),mt(t,n.gn,n.mn,n._n)}function Mt(t,n,e,i){n.mn=e,n._n=i,function(t,n,e,i){t.bindTexture(wn,n),t.texImage2D(wn,0,Fn,e,i,0,fn,sn,null),t.texParameteri(wn,Mn,mn),t.texParameteri(wn,_n,mn)}(t,n.Mn,n.mn,n._n),mt(t,n.gn,n.mn,n._n)}function gt(t,n,e,i){n.mn=e,n._n=i,vt(t,n.pn,n.mn,n._n),vt(t,n.wn,n.mn,n._n),vt(t,n.yn,n.mn,n._n),vt(t,n.bn,n.mn,n._n),mt(t,n.gn,n.mn,n._n)}function pt(t,n,e){let i=null,o=null,r=[];for(let l=0;l<t.o.t.length;l++)if((t.o.t[l]&We)===We){let a=t.o.Pt[l];if(1===a.Rt){r.push(l);continue}a.$t!==i&&(i=a.$t,wt(t,a,n)),a.Lt!==o&&(o=a.Lt,t.Cn.frontFace(a.Lt)),yt(t,l,e)}r.sort(((e,i)=>{let o=t.o.v[e];return P(t.o.v[i].o,n.q)-P(o.o,n.q)})),t.Cn.enable(rn);for(let l=0;l<r.length;l++){let a=r[l],c=t.o.Pt[a];c.$t!==i&&(i=c.$t,wt(t,c,n)),c.Lt!==o&&(o=c.Lt,t.Cn.frontFace(c.Lt)),yt(t,a,e)}t.Cn.disable(rn)}function wt(t,n,e){switch(n.L){case 0:case 4:case 7:case 8:case 9:t.Cn.useProgram(n.$t.An),t.Cn.uniformMatrix4fv(n.$t.kn.H,!1,e.H);break;case 1:case 5:case 6:t.Cn.useProgram(n.$t.An),t.Cn.uniformMatrix4fv(n.$t.kn.H,!1,e.H),t.Cn.uniform3fv(n.$t.kn.Tn,e.q),t.Cn.uniform4fv(n.$t.kn.qt,t.qt),t.Cn.uniform4fv(n.$t.kn.Ut,t.Ut);break;case 2:t.Cn.useProgram(n.$t.An),t.Cn.uniformMatrix4fv(n.$t.kn.H,!1,e.H),t.Cn.uniform3fv(n.$t.kn.Tn,e.q),t.Cn.uniform4fv(n.$t.kn.qt,t.qt),t.Cn.uniform4fv(n.$t.kn.Ut,t.Ut),t.Cn.activeTexture(yn),t.Cn.bindTexture(wn,t.En.xn.gn),t.Cn.uniform1i(n.$t.kn.Dn,0);let i=function(t,n,e=0){for(let i=e;i<t.t.length;i++)if((t.t[i]&n)===n)return i}(t.o,4104);if(i){let e=t.o.W[i];if(2===e.L)throw Error("XR cameras cannot be shadow sources.");t.Cn.uniformMatrix4fv(n.$t.kn.Fn,!1,e.H)}}}function yt(t,n,e){let i=t.o.v[n],o=t.o.Pt[n];switch(o.L){case 0:t.Cn.uniformMatrix4fv(o.$t.kn.o,!1,i.o),t.Cn.uniform4fv(o.$t.kn.Wt,o.Wt),t.Cn.bindVertexArray(o.It.Sn),t.Cn.drawElements(o.$t.Pn,o.It.$n,Pn,0),t.Cn.bindVertexArray(null);break;case 1:case 2:t.Cn.uniformMatrix4fv(o.$t.kn.o,!1,i.o),t.Cn.uniformMatrix4fv(o.$t.kn.et,!1,i.et),t.Cn.uniform4fv(o.$t.kn.zt,o.zt),t.Cn.uniform4fv(o.$t.kn.Gt,o.Gt),t.Cn.uniform4fv(o.$t.kn.Ot,o.Ot),t.Cn.bindVertexArray(o.It.Sn),t.Cn.drawElements(o.$t.Pn,o.It.$n,Pn,0),t.Cn.bindVertexArray(null);break;case 4:if(o.In===e)break;t.Cn.uniformMatrix4fv(o.$t.kn.o,!1,i.o),t.Cn.uniform4fv(o.$t.kn.Wt,o.Wt),t.Cn.activeTexture(yn),t.Cn.bindTexture(wn,o.In),t.Cn.uniform1i(o.$t.kn.Rn,0),t.Cn.bindVertexArray(o.It.Sn),t.Cn.drawElements(o.$t.Pn,o.It.$n,Pn,0),t.Cn.bindVertexArray(null);break;case 5:if(o.In===e)break;t.Cn.uniformMatrix4fv(o.$t.kn.o,!1,i.o),t.Cn.uniformMatrix4fv(o.$t.kn.et,!1,i.et),t.Cn.uniform4fv(o.$t.kn.zt,o.zt),t.Cn.uniform4fv(o.$t.kn.Gt,o.Gt),t.Cn.uniform4fv(o.$t.kn.Ot,o.Ot),t.Cn.activeTexture(yn),t.Cn.bindTexture(wn,o.In),t.Cn.uniform1i(o.$t.kn.Ln,0),t.Cn.bindVertexArray(o.It.Sn),t.Cn.drawElements(o.$t.Pn,o.It.$n,Pn,0),t.Cn.bindVertexArray(null);break;case 6:if(o.Ln===e)break;t.Cn.uniformMatrix4fv(o.$t.kn.o,!1,i.o),t.Cn.uniformMatrix4fv(o.$t.kn.et,!1,i.et),t.Cn.uniform4fv(o.$t.kn.zt,o.zt),t.Cn.activeTexture(bn),t.Cn.bindTexture(wn,o.Ln),t.Cn.uniform1i(o.$t.kn.Ln,1),t.Cn.activeTexture(Cn),t.Cn.bindTexture(wn,o.zn),t.Cn.uniform1i(o.$t.kn.zn,2),t.Cn.activeTexture(An),t.Cn.bindTexture(wn,o.Gn),t.Cn.uniform1i(o.$t.kn.Gn,3),t.Cn.bindVertexArray(o.It.Sn),t.Cn.drawElements(o.$t.Pn,o.It.$n,Pn,0),t.Cn.bindVertexArray(null);break;case 7:t.Cn.uniformMatrix4fv(o.$t.kn.o,!1,i.o),t.Cn.uniform4fv(o.$t.kn.Wt,o.Wt),t.Cn.bindBuffer(on,o.On),t.Cn.enableVertexAttribArray(0),t.Cn.vertexAttribPointer(0,3,$n,!1,0,0),t.Cn.drawArrays(o.$t.Pn,0,o.$n);break;case 8:{let e=t.o.rn[n];t.Cn.uniform4fv(o.$t.kn.Kn,o.Kn),t.Cn.uniform4fv(o.$t.kn.Nn,o.Nn),t.Cn.uniform4f(o.$t.kn.Bn,e.Yt,e.Vn,...o.ot);let i=Float32Array.from(e.cn);t.Cn.bindBuffer(on,o.G),t.Cn.bufferSubData(on,0,i),t.Cn.enableVertexAttribArray(o.$t.kn.Wn),t.Cn.vertexAttribPointer(o.$t.kn.Wn,4,$n,!1,4*be,0),t.Cn.enableVertexAttribArray(o.$t.kn.gt),t.Cn.vertexAttribPointer(o.$t.kn.gt,3,$n,!1,4*be,16),t.Cn.drawArrays(o.$t.Pn,0,e.cn.length/be);break}}}function bt(t,n){switch(t.L){case 0:!function(t,n,e,i,o){let r,l=1/Math.tan(n/2);t[0]=l/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(r=1/(i-o),t[10]=(o+i)*r,t[14]=2*o*i*r):(t[10]=-1,t[14]=-2*i)}(t.Y,n<1?t.Yn/n:t.Yn,n,t.Xn,t.Z);break;case 1:n<t.jn[0]/t.jn[1]?E(t.Y,t.jn[0]/n,t.jn[0],-t.jn[0]/n,-t.jn[0],t.Xn,t.Z):E(t.Y,t.jn[1],t.jn[1]*n,-t.jn[1],-t.jn[1]*n,t.Xn,t.Z)}k(t.Hn,t.Y)}function Ct(t,n){let e=t.o.qn[n],i=t.o.v[n];i.D[0]=(Math.random()-.5)*e.jn*2,i.D[1]=(Math.random()-.5)*e.jn*2,i.D[2]=(Math.random()-.5)*e.jn*2,t.o.t[n]|=256}function At(t,e,i){let o=t.o.Un[e];if(o.ln+=i,o.ln>o.Jn){o.ln=0;let i=t.o.v[e];F(je,i.o),S(He,i.o),n(t,[...o.Qn(t),(l=je,(t,n)=>{u(t.o.v[n].D,l)}),(r=He,(t,n)=>{var e,i;(e=t.o.v[n].F)[0]=(i=r)[0],e[1]=i[1],e[2]=i[2],e[3]=i[3]})])}var r,l}function kt(t,n,e){let i=t.o.Zn[n];i.ln+=e,i.ln>i.an&&(i.ln=0,(t.o.t[n]&i.st)===i.st?t.o.t[n]&=~i.st:t.o.t[n]|=i.st)}function Tt(t,n){for(let n=0;n<t.o.t.length;n++)(t.o.t[n]&Ue)===Ue&&xt(t.o,n,t.o.v[n])}function xt(t,n,e){if(t.t[n]&=-257,x(e.o,e.F,e.D,e.S),void 0!==e.nn&&(T(e.o,t.v[e.nn].o,e.o),e.Kt&&(F(Je,e.o),x(e.o,e.F,Je,e.S))),k(e.et,e.o),16&t.t[n]){let e=t.l[n];for(let i=0;i<e.l.length;i++){let o=e.l[i];if(4194304&t.t[o]){let e=t.v[o];e.nn=n,xt(t,o,e)}}}}function Et(t,n){let e=t.o.vn[n],i=t.o._[n];for(let o of e.ft)i.st&t.o.vn[o.ht].ut&&r(t,i.jt,[n,o.ht])}function Dt(t,...n){return t.reduce(((t,e)=>t+function(t){let n=t.shift();return"boolean"==typeof n||null==n?"":Array.isArray(n)?n.join(""):n}(n)+e))}function Ft(t,n=.1){return(e,i)=>{e.o.t[i]|=8192,e.o.Qt[i]={Zt:t,tn:n}}}function St(t,n,e=0){for(let i=e;i<t.t.length;i++)if(32768&t.t[i]&&t.ne[i].te===n)return i;throw`No entity named ${n}.`}function Pt(t){return[J(),Ft(St(t.o,"camera anchor")),e([J([0,1,-6],[0,1,0,0]),O({L:0,Yn:1,Xn:.1,Z:1e3,Y:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Hn:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},[.1,.5,.8,1])])]}function $t(t,n,e,i=[1,1,1]){return(o,r)=>{o.o.t[r]|=32,o.o.vn[r]={dt:r,ee:!0,ie:t,ut:n,st:e,ot:i,rt:[0,0,0],lt:[0,0,0],it:[0,0,0],ct:[0,0,0],ft:[]}}}function It(t){return[J(),$t(!1,2,0),ct(0),e([J([0,I(-.2,.2),0]),U(t.oe,t.re,[0,1,.1,1])])]}function Rt(t,n){return(e,i)=>{let o=t?e.Audio.createPanner():void 0;e.o.t[i]|=4,e.o.$[i]={R:o,V:n,p:0}}}function Lt(t){return(n,e)=>{t(n,e)}}function zt(t,n,e){return(i,o)=>{i.o.t[o]|=64,i.o._t[o]={gt:t,F:n,Animation:e}}}function Gt(t){return(n,e)=>{n.o.t[e]&=~t}}function Ot(t=[1,1,1],n=1){return(e,i)=>{e.o.t[i]|=4096,e.o.Ht[i]={L:2,Wt:t,Jt:n}}}function Kt(t=[1,1,1],n=1){return(e,i)=>{e.o.t[i]|=4096,e.o.Ht[i]={L:3,Wt:t,Jt:n}}}function Nt(t,n){return(e,i)=>{e.o.t[i]|=16384,e.o.Mt[i]={en:t,on:n,gt:[0,0,0],wt:[0,0,0,1],Dt:[0,0,0,1]}}}function Bt(t){return(n,e)=>{n.o.t[e]|=262144,n.o.qn[e]={jn:t}}}function Vt(t){let n,i,o;return[J(),Lt(((t,e)=>n=e)),$t(!0,8,3),(t,n)=>{t.o.t[n]|=8388608,t.o._[n]={st:1,jt:1}},ct(1,.3),Rt(!0),(a=5,c=2,(t,n)=>{t.o.t[n]|=2048,t.o.Yt[n]={Xt:a,jt:c}}),Gt(2048),e([Lt(((t,n)=>i=n)),J(void 0,void 0,[.5,.7,.1]),zt(null,[0,1,0,0]),Nt(0,.2),Bt(.05),(r=262144,l=1,(t,n)=>{t.o.t[n]|=2097152,t.o.Zn[n]={st:r,an:l,ln:0}}),Gt(2359296),e([J([0,1,0]),U(t.oe,t.re,[5,3,0,1]),e([J([0,1,0]),Kt([1,.5,0],3)])])],[J([0,1.5,0]),zt(null,[0,1,0,0]),Nt(0,2),e([J([0,0,.2],w([0,0,0,1],-90,0,0)),e([Lt(((t,n)=>o=n)),J(),Bt(.05),(t,n)=>{t.o.t[n]|=1024,t.o.rn[n]={Yt:2,an:.2,Vn:1,cn:[],ln:0}},(u=t.le,f=[1,1,1,1],h=[1,1,1,0],(t,n)=>{let e=t.Cn.createBuffer();t.Cn.bindBuffer(on,e),t.Cn.bufferData(on,Ce*be*4,en),t.o.t[n]|=65536,t.o.Pt[n]={L:8,$t:u,Rt:f[3]<1||h[3]<1?1:0,G:e,Kn:f,Nn:h,ot:[5,1],Lt:ln}})])])],[e([(t,n)=>{t.o.t[n]|=1048576,t.o.ae[n]={L:1,Xt:10}}]),(s=()=>{t.o.t[n]|=2048,t.o.t[i]|=2359296,t.o.qn[o].jn=.1;let e=t.o.rn[o];e.Yt=1,e.an=.1;let r=t.o.Pt[o];r.Kn=[1,1,0,1],r.Nn=[1,0,0,0],r.ot=[10,5]},(t,n)=>{t.o.t[n]|=1048576,t.o.ae[n]={L:2,ce:s}})])];var r,l,a,c,s,u,f,h}function Wt(t){return[J(),$t(!0,4,3),ct(1,.3),e([J(),U(t.oe,t.re,[.5,.5,.5,.3])])]}function Yt(t){return t*t}function Xt(t){return 1-(1-t)**2}function jt(t){return t<.5?2*t*t:1-(-2*t+2)**2/2}function Ht(t,n,e,i=0,o=0){return(r,l)=>{r.o.t[l]|=128,r.o.bt[l]={Mt:t,Tt:n,xt:e,Et:i,Ft:o}}}function qt(t){return[J(),Ht(!0,.2,0),Nt(10,3),$t(!0,1,2),ct(1),Rt(!1),(t,n)=>{t.o.t[n]|=2},e([J(),U(t.oe,t.re,[1,.3,.2,1]),(n={idle:{A:[{k:0,F:w([0,0,0,1],0,-5,0),T:jt},{k:1,F:w([0,0,0,1],0,5,0),T:jt}]},jump:{A:[{k:0,F:[0,0,0,1]},{k:.5,F:[1,0,0,0],T:Yt},{k:1,F:[0,0,0,-1],T:Xt}],C:0}},(t,e)=>{let i={};for(let t in n){let{A:e,C:o=7}=n[t],r=e[e.length-1].k;i[t]={A:e.map((t=>({...t}))),C:o,P:r,p:0}}t.o.t[e]|=1,t.o.m[e]={M:i,g:i.idle}})],[J(),(t,n)=>{t.o.t[n]|=32768,t.o.ne[n]={te:"camera anchor"}},Nt(0,3),Ht(!1,0,.2,-10,80)],[J([0,2,0]),Kt([1,1,1],5)])];var n}var Ut,Jt,Qt,Zt=256,tn=16384,nn=35044,en=35048,on=34962,rn=3042,ln=2304,an=5121,cn=5125,sn=5126,un=6402,fn=6408,hn=35632,dn=35633,vn=9728,mn=9729,_n=10240,Mn=10241,gn=10242,pn=10243,wn=3553,yn=33984,bn=33985,Cn=33986,An=33987,kn=33071,Tn=32856,xn=34892,En=34894,Dn=34836,Fn=34842,Sn=33190,Pn=5123,$n=5126,In=class{se;t=[];i=[];constructor(t=1e4){this.se=t}},Rn=document.getElementById("update"),Ln=document.getElementById("delta"),zn=document.getElementById("fps"),Gn=class{ue=0;fe=0;X=window.innerWidth;j=window.innerHeight;he=!0;Ct={MouseX:0,MouseY:0};St={MouseX:0,MouseY:0};de={Mouse:0,Mouse0:0,Mouse1:0,Mouse2:0,Touch0:0,Touch1:0};ve={};me=document.querySelector("main");constructor(){document.addEventListener("visibilitychange",(()=>document.hidden?this._e():this.Me())),this.me.addEventListener("contextmenu",(t=>t.preventDefault())),this.me.addEventListener("mousedown",(t=>{this.Ct["Mouse"+t.button]=1,this.St["Mouse"+t.button]=1})),this.me.addEventListener("mouseup",(t=>{this.Ct["Mouse"+t.button]=0,this.St["Mouse"+t.button]=-1})),this.me.addEventListener("mousemove",(t=>{this.Ct.MouseX=t.clientX,this.Ct.MouseY=t.clientY,this.St.MouseX=t.movementX,this.St.MouseY=t.movementY})),this.me.addEventListener("wheel",(t=>{t.preventDefault(),this.St.WheelY=t.deltaY})),this.me.addEventListener("touchstart",(t=>{t.target===this.me&&t.preventDefault(),1===t.touches.length&&(this.ve={});for(let n=0;n<t.touches.length;n++)this.ve[t.touches[n].identifier]=n;for(let n=0;n<t.changedTouches.length;n++){let e=t.changedTouches[n],i=this.ve[e.identifier];this.Ct["Touch"+i]=1,this.Ct[`Touch${i}X`]=e.clientX,this.Ct[`Touch${i}Y`]=e.clientY,this.St["Touch"+i]=1,this.St[`Touch${i}X`]=0,this.St[`Touch${i}Y`]=0}})),this.me.addEventListener("touchmove",(t=>{t.target===this.me&&t.preventDefault();for(let n=0;n<t.changedTouches.length;n++){let e=t.changedTouches[n],i=this.ve[e.identifier];this.St[`Touch${i}X`]=e.clientX-this.Ct[`Touch${i}X`],this.St[`Touch${i}Y`]=e.clientY-this.Ct[`Touch${i}Y`],this.Ct[`Touch${i}X`]=e.clientX,this.Ct[`Touch${i}Y`]=e.clientY}})),this.me.addEventListener("touchend",(t=>{t.target===this.me&&t.preventDefault();for(let n=0;n<t.changedTouches.length;n++){let e=this.ve[t.changedTouches[n].identifier];this.Ct["Touch"+e]=0,this.St["Touch"+e]=-1}})),this.me.addEventListener("touchcancel",(t=>{for(let n=0;n<t.changedTouches.length;n++){let e=this.ve[t.changedTouches[n].identifier];this.Ct["Touch"+e]=0,this.St["Touch"+e]=-1}})),window.addEventListener("keydown",(t=>{t.repeat||(this.Ct[t.code]=1,this.St[t.code]=1)})),window.addEventListener("keyup",(t=>{this.Ct[t.code]=0,this.St[t.code]=-1}))}Me(){let t=performance.now(),n=e=>{let i=(e-t)/1e3;t=e,this.ue=requestAnimationFrame(n),this.ge(i),this.pe(i),this.we(i)};requestAnimationFrame(n)}_e(){cancelAnimationFrame(this.ue),this.ue=0}ge(t){this.fe=performance.now();let n=Math.abs(this.St.MouseX)+Math.abs(this.St.MouseY);this.de.Mouse+=n,1===this.Ct.Mouse0&&(this.de.Mouse0+=n),1===this.Ct.Mouse1&&(this.de.Mouse1+=n),1===this.Ct.Mouse2&&(this.de.Mouse2+=n),1===this.Ct.Touch0&&(this.de.Touch0+=Math.abs(this.St.Touch0X)+Math.abs(this.St.Touch0Y)),1===this.Ct.Touch1&&(this.de.Touch1+=Math.abs(this.St.Touch1X)+Math.abs(this.St.Touch1Y))}pe(t){}we(t){this.he=!1,-1===this.St.Mouse0&&(this.de.Mouse0=0),-1===this.St.Mouse1&&(this.de.Mouse1=0),-1===this.St.Mouse2&&(this.de.Mouse2=0),-1===this.St.Touch0&&(this.de.Touch0=0),-1===this.St.Touch1&&(this.de.Touch1=0);for(let t in this.St)this.St[t]=0;let n=performance.now()-this.fe;Rn&&(Rn.textContent=n.toFixed(1)),Ln&&(Ln.textContent=(1e3*t).toFixed(1)),zn&&(zn.textContent=(1/t).toFixed())}},On=class extends Gn{ye=document.querySelector("#background");be=this.ye.getContext("2d");Ce=document.querySelector("#foreground");Nt=this.Ce.getContext("2d");Ae=document.querySelector("#scene");Cn=this.Ae.getContext("webgl2");Audio=new AudioContext;ke=[];En={};constructor(){super(),this.Cn.enable(2929),this.Cn.enable(2884),this.Cn.blendFunc(770,771)}},Kn=class extends In{m=[];$=[];W=[];l=[];vn=[];_t=[];bt=[];Te=[];rn=[];Yt=[];Ht=[];Qt=[];Mt=[];ne=[];Pt=[];yt=[];qn=[];Un=[];ae=[];Zn=[];v=[];_=[]},Nn=Float32Array.from([-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5]),Bn=Float32Array.from([-1,0,0,0,-1,0,0,0,1,-1,0,0,0,0,1,0,1,0,-1,0,0,0,-1,0,0,0,-1,-1,0,0,0,0,-1,0,1,0,0,-1,0,0,0,1,1,0,0,0,0,1,0,1,0,1,0,0,0,-1,0,0,0,-1,1,0,0,0,0,-1,0,1,0,1,0,0]),Vn=Float32Array.from([.67,.67,1,1,.67,.33,.33,.67,.67,.67,0,0,.67,1,1,.67,.33,.33,.33,1,0,.33,.33,0,.67,1,.33,.33,.33,1,.33,.67,0,.33,0,1,.67,.67,.33,.67,.33,.67,0,.67,.33,.33,0,.67]),Wn=Float32Array.from([]),Yn=Uint16Array.from([16,5,22,5,11,22,1,12,7,12,18,7,2,4,13,4,15,13,14,17,20,17,23,20,19,21,8,21,10,8,6,9,0,9,3,0]),Xn=1e-6,jn=Math.PI/180,Hn=180/Math.PI,qn=4194305,Un=4194306,Jn=[0,0,0],Qn=[0,0,0],Zn=[0,0,0],te=1,ne=4194308,ee=[0,0,0],ie=[0,0,0],oe=4194312,re=[[.5,.5,.5],[.5,.5,-.5],[-.5,.5,-.5],[-.5,.5,.5],[.5,-.5,.5],[.5,-.5,-.5],[-.5,-.5,-.5],[-.5,-.5,.5]],le=4194336,ae=4210752,ce=131200,se=4210816,ue=[1,0,0],fe=[0,1,0],he=[0,0,0,0],de=[0,1,0],ve=[1,0,0],me=.01,_e=10,Me=[0,0],ge=[0,0,0,0],pe=[0,1,0],we=[1,0,0],ye=.1,be=8,Ce=200,Ae=4194816,ke=4198400,Te=[0,0,0],xe=4202496,Ee=[0,0,0],De=[0,0,0,1],Fe=4210688,Se=4195328,Pe=[0,0,0],$e=[0,0,0],Ie=4325376,Re=-9.81,Le=[0,0,0],ze=4325376,Ge=[0,0,0],Oe=[0,0,0],Ke=4325408,Ne=[0,0,0],Be=[0,0,0],Ve=1048576,We=4259840,Ye=4456448,Xe=4718592,je=[0,0,0],He=[0,0,0,0],qe=2097152,Ue=4194560,Je=[0,0,0],Qe=12582944,Ze=new class extends On{o=new Kn;xe=function(t){return function(t,n=4){let e=l(t,"#version 300 es\n\nuniform mat4 pv;\nuniform mat4 world;\n\nlayout(location=0) in vec4 attr_position;\n\nvoid main() {\ngl_Position = pv * world * attr_position;\n}\n","#version 300 es\n\nprecision mediump float;\n\nuniform vec4 color;\n\nout vec4 frag_color;\n\nvoid main() {\nfrag_color = color;\n}\n");return{Pn:n,An:e,kn:{H:t.getUniformLocation(e,"pv"),o:t.getUniformLocation(e,"world"),Wt:t.getUniformLocation(e,"color")}}}(t,2)}(this.Cn);oe=function(t){let n=l(t,"#version 300 es\n\nuniform mat4 pv;\nuniform mat4 world;\nuniform mat4 self;\n\nlayout(location=0) in vec4 attr_position;\nlayout(location=1) in vec3 attr_normal;\n\nout vec4 vert_position;\nout vec3 vert_normal;\n\nvoid main() {\nvert_position = world * attr_position;\nvert_normal = (vec4(attr_normal, 0.0) * self).xyz;\ngl_Position = pv * vert_position;\n}\n","#version 300 es\n\nprecision mediump float;\n\nuniform vec3 eye;\nuniform vec4 diffuse_color;\nuniform vec4 specular_color;\nuniform vec4 emissive_color;\nuniform vec4 light_positions[8];\nuniform vec4 light_details[8];\n\nin vec4 vert_position;\nin vec3 vert_normal;\n\nout vec4 frag_color;\n\n\n\n\n\n\nvec3 GAMMA_DECODE(vec3 rgb) {\nreturn pow(rgb, vec3(2.2));\n}\n\n\nvec4 GAMMA_DECODE(vec4 color) {\nreturn vec4(pow(color.rgb, vec3(2.2)), color.a);\n}\n\n\n\n\n\n\nvec3 GAMMA_ENCODE(vec3 rgb) {\nreturn pow(rgb, vec3(1.0 / 2.2));\n}\n\n\nvec4 GAMMA_ENCODE(vec4 color) {\nreturn vec4(pow(color.rgb, vec3(1.0 / 2.2)), color.a);\n}\n\n\nvoid main() {\nvec3 world_normal = normalize(vert_normal);\n\nvec3 view_dir = eye - vert_position.xyz;\nvec3 view_normal = normalize(view_dir);\n\n\nvec3 light_acc = GAMMA_DECODE(diffuse_color.rgb) * 0.1;\n\nfor (int i = 0; i < 8; i++) {\nint light_kind = int(light_positions[i].w);\nif (light_kind == 0) {\nbreak;\n}\n\nvec3 light_rgb = GAMMA_DECODE(light_details[i].rgb);\nfloat light_intensity = light_details[i].a;\n\nvec3 light_normal;\nif (light_kind == 2) {\nlight_normal = light_positions[i].xyz;\n} else if (light_kind == 3) {\nvec3 light_dir = light_positions[i].xyz - vert_position.xyz;\nfloat light_dist = length(light_dir);\nlight_normal = light_dir / light_dist;\n\nlight_intensity /= (light_dist * light_dist);\n}\n\nfloat diffuse_factor = dot(world_normal, light_normal);\nif (diffuse_factor > 0.0) {\n\nlight_acc += GAMMA_DECODE(diffuse_color.rgb) * diffuse_factor * light_rgb * light_intensity;\n\nif (specular_color.a > 0.0) {\n\n\n\n\n\n\nvec3 h = normalize(light_normal + view_normal);\nfloat specular_angle = max(dot(h, world_normal), 0.0);\nfloat specular_factor = pow(specular_angle, specular_color.a);\n\n\nlight_acc += GAMMA_DECODE(specular_color.rgb) * specular_factor * light_rgb * light_intensity;\n}\n}\n}\n\nvec3 emissive_rgb = GAMMA_DECODE(emissive_color.rgb) * emissive_color.a;\nfrag_color = vec4(GAMMA_ENCODE(light_acc + emissive_rgb), diffuse_color.a);\n}\n");return{Pn:4,An:n,kn:{H:t.getUniformLocation(n,"pv"),o:t.getUniformLocation(n,"world"),et:t.getUniformLocation(n,"self"),zt:t.getUniformLocation(n,"diffuse_color"),Gt:t.getUniformLocation(n,"specular_color"),Ot:t.getUniformLocation(n,"emissive_color"),Tn:t.getUniformLocation(n,"eye"),qt:t.getUniformLocation(n,"light_positions"),Ut:t.getUniformLocation(n,"light_details")}}}(this.Cn);le=function(t){let n=l(t,"#version 300 es\n\nuniform mat4 pv;\nuniform vec4 color_start;\nuniform vec4 color_end;\n\nuniform vec4 details;\n\n\nin vec4 attr_origin_age;\nin vec3 attr_direction;\n\nout vec4 vert_color;\n\nvoid main() {\n\nvec3 velocity = attr_direction * details.y;\ngl_Position = pv * vec4(attr_origin_age.xyz + velocity * attr_origin_age.w, 1.0);\n\n\nfloat t = attr_origin_age.w / details.x;\ngl_PointSize = mix(details.z, details.w, t);\nvert_color = mix(color_start, color_end, t);\n}\n","#version 300 es\n\nprecision mediump float;\n\nin vec4 vert_color;\n\nout vec4 frag_color;\n\nvoid main() {\nfrag_color = vert_color;\n}\n");return{Pn:0,An:n,kn:{H:t.getUniformLocation(n,"pv"),Kn:t.getUniformLocation(n,"color_start"),Nn:t.getUniformLocation(n,"color_end"),Bn:t.getUniformLocation(n,"details"),Wn:t.getAttribLocation(n,"attr_origin_age"),gt:t.getAttribLocation(n,"attr_direction")}}}(this.Cn);re=function(t){let n=t.createVertexArray();t.bindVertexArray(n);let e=t.createBuffer();t.bindBuffer(on,e),t.bufferData(on,Nn,nn),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,3,$n,!1,0,0);let i=t.createBuffer();t.bindBuffer(on,i),t.bufferData(on,Bn,nn),t.enableVertexAttribArray(1),t.vertexAttribPointer(1,3,$n,!1,0,0);let o=t.createBuffer();t.bindBuffer(on,o),t.bufferData(on,Vn,nn),t.enableVertexAttribArray(2),t.vertexAttribPointer(2,2,$n,!1,0,0);let r=t.createBuffer();t.bindBuffer(on,r),t.bufferData(on,Wn,nn),t.enableVertexAttribArray(5),t.vertexAttribPointer(5,4,$n,!1,0,0);let l=t.createBuffer();return t.bindBuffer(34963,l),t.bufferData(34963,Yn,nn),t.bindVertexArray(null),{Sn:n,On:e,Ee:Nn,De:i,Fe:Bn,Se:o,Pe:Vn,$e:r,Ie:Wn,Re:l,Le:Yn,$n:Yn.length}}(this.Cn);qt=new Float32Array(32);Ut=new Float32Array(32);u=0;h=0;pe(n){!function(n,e){let i=[];for(let t=0;t<n.o.t.length;t++)if((n.o.t[t]&Ve)===Ve){if(dt(n.o,t))continue;let o=n.o.ae[t];switch(o.L){case 0:o.ze(t)&&i.push(t);break;case 1:o.Xt-=e,o.Xt<0&&i.push(t);break;case 2:i.push(t)}}for(let e of i){let i=n.o.ae[e];switch(i.L){case 2:i.ce(e);case 0:case 1:t(n.o,e)}delete n.o.ae[e]}}(this,n),function(t,n){for(let e=0;e<t.o.t.length;e++)(t.o.t[e]&Ie)===Ie&&st(t,e,n)}(this,n),Tt(this),function(t,n){for(let e=0;e<t.o.t.length;e++)(t.o.t[e]&ze)===ze&&ut(t,e,n)}(this,n),function(t,n){let e=[],i=[];for(let n=0;n<t.o.t.length;n++)if((t.o.t[n]&le)===le){let o=t.o.v[n],r=t.o.vn[n];r.ft=[],r.ee?(r.ee=!1,N(o.o,r)):r.ie?(N(o.o,r),i.push(r)):e.push(r)}for(let t=0;t<i.length;t++)V(i[t],e,e.length),V(i[t],i,t)}(this),function(t,n){for(let n=0;n<t.o.t.length;n++)(t.o.t[n]&Ke)===Ke&&ft(t,n);for(let n=0;n<t.o.t.length;n++)if((t.o.t[n]&Ke)===Ke){let e=t.o.yt[n];1===e.L&&u(e.fn,e.hn)}}(this),Tt(this),function(t,n){for(let n=0;n<t.o.t.length;n++)(t.o.t[n]&Qe)===Qe&&Et(t,n)}(this),function(t,n){if(t.X==window.innerWidth&&t.j==window.innerHeight||(t.he=!0),t.he){t.X=t.ye.width=t.Ae.width=t.Ce.width=window.innerWidth,t.j=t.ye.height=t.Ae.height=t.Ce.height=window.innerHeight;for(let n of Object.values(t.En))if(n.Ge)switch(n.L){case 0:_t(t.Cn,n,t.X,t.j);break;case 1:Mt(t.Cn,n,t.X,t.j);break;case 2:gt(t.Cn,n,t.X,t.j)}for(let n=0;n<t.o.t.length;n++)if(8==(8&t.o.t[n])){let e=t.o.W[n];switch(e.L){case 0:e.X=t.X,e.j=t.j,bt(e.Y,t.X/t.j);break;case 1:e.X=t.X,e.j=t.j,bt(e.Y,e.Zt.mn/e.Zt._n)}}}}(this),function(t,n){t.ke=[];for(let n=0;n<t.o.t.length;n++)if((t.o.t[n]&oe)===oe){let o=t.o.W[n];switch((e=o.o)[0]=(i=t.o.v[n].o)[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],o.L){case 0:case 1:K(t,n,o),t.ke.push(n)}}var e,i}(this),function(t,n){for(let n=0;n<t.o.t.length;n++)16512==(16512&t.o.t[n])&&X(t,n)}(this),function(t,n){for(let n=0;n<t.o.t.length;n++)(t.o.t[n]&se)===se&&j(t,n)}(this),function(t,n){1===t.St.Touch0&&(Me[0]=t.Ct.Touch0X,Me[1]=t.Ct.Touch0Y);for(let n=0;n<t.o.t.length;n++)16512==(16512&t.o.t[n])&&H(t,n)}(this),function(t,n){for(let n of navigator.getGamepads())n&&(t.St[`pad${n.index}_axis_1`]=n.axes[0],t.St[`pad${n.index}_axis_2`]=n.axes[1],t.St[`pad${n.index}_axis_3`]=n.axes[2],t.St[`pad${n.index}_axis_4`]=n.axes[3]);for(let n=0;n<t.o.t.length;n++)16512==(16512&t.o.t[n])&&q(t,n)}(this),function(t,n){for(let n=0;n<t.o.t.length;n++)(t.o.t[n]&ce)===ce&&Y(t,n)}(this),function(t,n){for(let n=0;n<t.o.t.length;n++)(t.o.t[n]&ae)===ae&&W(t,n)}(this),function(t,n){for(let e=0;e<t.o.t.length;e++)(t.o.t[e]&qn)===qn&&A(t,e,n)}(this,n),function(t,n){for(let e=0;e<t.o.t.length;e++)(t.o.t[e]&Fe)===Fe&&lt(t,e,n)}(this,n),function(t,n){for(let n=0;n<t.o.t.length;n++)(t.o.t[n]&xe)===xe&&rt(t,n)}(this),function(t,n){for(let e=0;e<t.o.t.length;e++)2048==(2048&t.o.t[e])&&it(t,e,n)}(this,n),function(t,n){for(let n=0;n<t.o.t.length;n++)(t.o.t[n]&Ye)==Ye&&Ct(t,n)}(this),function(t,n){for(let e=0;e<t.o.t.length;e++)(t.o.t[e]&qe)==qe&&kt(t,e,n)}(this,n),function(t,n){for(let e=0;e<t.o.t.length;e++)(t.o.t[e]&Xe)==Xe&&At(t,e,n)}(this,n),function(t,n){for(let e=0;e<t.o.t.length;e++)(t.o.t[e]&Se)==Se&&at(t,e,n)}(this,n),Tt(this),function(t,n){for(let n=0;n<t.o.t.length;n++)(t.o.t[n]&Un)===Un&&$(t,n)}(this),function(t,n){for(let e=0;e<t.o.t.length;e++)(t.o.t[e]&ne)===ne&&z(t,e,n)}(this,n),function(t,n){t.qt.fill(0),t.Ut.fill(0);let e=0;for(let n=0;n<t.o.t.length;n++)(t.o.t[n]&ke)===ke&&ot(t,n,e++)}(this),function(t,n){for(let n of t.ke){let e=t.o.W[n];switch(e.L){case 0:t.Cn.bindFramebuffer(36160,null),t.Cn.viewport(0,0,e.X,e.j),t.Cn.clearColor(...e.tt),t.Cn.clear(e.nt),pt(t,e);break;case 1:0===e.Zt.L&&(t.Cn.bindFramebuffer(36160,e.Zt.Oe),t.Cn.viewport(0,0,e.Zt.mn,e.Zt._n),t.Cn.clearColor(...e.tt),t.Cn.clear(e.nt),pt(t,e,e.Zt.Mn))}}}(this),function(t,n){t.Nt.resetTransform(),t.Nt.clearRect(0,0,t.X,t.j);let e=[0,0,0],i=t.o.W[t.ke[0]];if(i&&2!==i.L)for(let n=0;n<t.o.t.length;n++)if((t.o.t[n]&Ae)==Ae){if(F(e,t.o.v[n].o),m(e,e,i.H),e[2]<-1||e[2]>1)continue;t.Nt.setTransform(1,0,0,1,.5*(e[0]+1)*t.X,.5*(1-e[1])*t.j);let o=t.o.Te[n];switch(o.L){case 0:nt(t,o);break;case 3:et(t,o)}}}(this),function(t,n){let e=function(t){return Dt`<div>${Dt`
<div
style="
position: absolute;
top: 1vmin;
left: 1vmin;
background: #000;
color: #fff;
font: 13px Arial;
"
>
<button
onclick="$(${0})"
style="
padding: 1vmin;
background: #000;
color: #fff;
border: none;
"
>
${document.fullscreenElement?"Exit Fullscreen":"Enter Fullscreen"}
</button>
</div>
`} ${function(t){return Dt`
<div
style="
position: absolute;
right: 0;
bottom: 0;
left: 0;
height: 10vmin;

display: flex;
justify-content: space-around;
align-items: center;

background: rgba(0, 0, 0, 0.5);
color: #fff;
font: 24px Impact;
font-style: italic;
"
>
<div>Collected: ${t.u}</div>
<div>Missed: ${t.h}</div>
</div>
`}(t)}</div>`}(t);e!==Jt&&(t.me.innerHTML=Jt=e)}(this)}};(Qt=Ze).me.addEventListener("click",(()=>Qt.me.requestPointerLock())),function(t){t.o=new Kn,t.he=!0;for(let e=0;e<10;e++)for(let i=0;i<10;i++)n(t,[...It(t),Q(5*(i-5),0,5*(e-5)),tt(5,1,5)]);var i;n(t,[J(),Z(-30,30,0),Ot([1,1,1],.1)]),n(t,[...qt(t),Q(0,1,0),Z(0,180,0)]),n(t,[...Pt(t),Q(0,1e3,1e3),Z(0,180,0)]),n(t,[J([0,15,0]),zt(null,[0,1,0,0]),Nt(0,1),e([J([0,0,10]),e([J(),Bt(10),(i=Vt,(t,n)=>{t.o.t[n]|=524288,t.o.Un[n]={Qn:i,Jn:3,ln:3}})])])]);for(let e=0;e<100;e++)n(t,[...Wt(t),Q(I(-10,10),1,I(-10,10)),tt(I(.5,1.5),I(.5,1.5),I(.5,1.5))])}(Ze),Ze.Me(),window.$=r.bind(null,Ze),window.game=Ze})();
